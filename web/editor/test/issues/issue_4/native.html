<!DOCTYPE html>
<!--
Explore native dotted/dashed line support in <canvas>
Mainly based on http://www.rgraph.net/blog/2013/january/html5-canvas-dashed-lines.html#introduction
and my research
-->
<html>
    <head>
        <title>Native dotted/dashed line</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <script type="text/javascript" src="./context_dotted.js"></script>
        <script type="text/javascript">
            function pageLoaded(){
                console.info("Page Loaded");
                
                paintGrid();
                
                enhanceContext();
                
//                repaint();
                testMozilla();
            }
            
            function enhanceContext(){

            }
            
            
            var i = 0;
            function repaint(){
                var quilt = document.getElementById("quilt");
                var ctx = quilt.getContext('2d');
                
                
                
                
                paintQuilt();
                
                
//                setTimeout(repaint, 1000);
            }
            
            function testMozilla(){
                var quilt = document.getElementById("quilt");
                var ctx = quilt.getContext('2d');
                
                ctx.lineDashOffset = 5;
//                ctx.mozDashOffset = 5;
//                ctx.mozLineDash = [2,4];
                ctx.setLineDash([10,10]);
//                ctx.setLineDashOffset(10);
                
                ctx.beginPath();
                ctx.moveTo(0,0);
                ctx.lineTo(150, 150);
                ctx.stroke();
                
                console.info("   ")
            }
            
            function paintGrid(){
                var quilt = document.getElementById("quilt");
                var ctx = quilt.getContext('2d');
                
                ctx.save();
                ctx.beginPath();
                ctx.strokeStyle = 'rgba(10,10,10,0.1)';
                
                //columns
                for(var i=0;i<quilt.width;i+=20){
                    ctx.moveTo(i, 0);
                    ctx.lineTo(i, quilt.height);
                }
                
                //rows
                for(var i=0;i<quilt.height;i+=20){
                    ctx.moveTo(0, i);
                    ctx.lineTo(quilt.width, i);
                }
                ctx.stroke();
                
                ctx.restore();
            }
            
            function paintQuilt(){
                var quilt = document.getElementById("quilt");
                //quilt.width = quilt.width;
                
                var ctx = quilt.getContext('2d');
                ctx.save();
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(0,0,quilt.width, quilt.height);
                
                
//                i = (i + 1) % 2;
                ctx.mozDashOffset = 1;
                ctx.mozLineDash = [2,4];
//                ctx.setLineDash([2,4]); //                
//                ctx.setLineDash([1,2]);
//                ctx.lineWidth = 6;
                ctx.lineCap = 'round';
//                ctx.lineCap = 'bevel';
//                ctx.lineCap = 'miter';
                
                console.info("Line dash = " + ctx.getLineDash());
//                ctx.mozDash = [5];
//                ctx.translate(0.5, 0.5);
                
                
                //first line
                ctx.beginPath();
                ctx.moveTo(10,10);
                ctx.lineTo(50, 10);
                ctx.lineTo(100, 50);
                ctx.lineTo(100, 100);
                ctx.stroke();
                
                //circle
                ctx.beginPath();
//                ctx.moveTo(50, 150);
                ctx.arc(50, 150, 40, 0, 2 * Math.PI, false);                
//                ctx.arc(65,65,50,0,2 * Math.PI,false);                
                ctx.stroke();
                
                ctx.restore();
            }
            
            window.addEventListener("load", pageLoaded, false);
        </script>
    </head>
    <body>
        <div>
            <canvas style="border: 1px solid red;" id="quilt" width="300" height="300"></canvas>
        </div>
    </body>
</html>
